<ion-content [fullscreen]="true" class="fondo">
  <ion-text color="danger" *ngIf="mensajeError">
    <p class="ion-padding">{{ mensajeError }}</p>
  </ion-text>
  <ion-text color="success" *ngIf="mensajeOk">
    <p class="ion-padding">{{ mensajeOk }}</p>
  </ion-text>

  <form
    [formGroup]="formCliente"
    (ngSubmit)="guardarCliente()"
  >
  <div>

    <div class="input-group">
     <ion-item>
       <ion-input formControlName="nombre" placeholder="Nombre"></ion-input>
     </ion-item>
     <div
       class="error-tooltip"
       *ngIf="formCliente.get('nombre')?.touched && formCliente.get('nombre')?.invalid"
     >
       <span *ngIf="formCliente.get('nombre')?.hasError('required')">El nombre es obligatorio</span>
     </div>
   </div>
 
   <div class="input-group">
     <ion-item>
       <ion-input formControlName="apellido" placeholder="Apellido"></ion-input>
     </ion-item>
     <div
       class="error-tooltip"
       *ngIf="formCliente.get('apellido')?.touched && formCliente.get('apellido')?.invalid"
     >
       <span *ngIf="formCliente.get('apellido')?.hasError('required')">El apellido es obligatorio</span>
     </div>
   </div>
 
   <div class="input-group">
     <ion-item>
       <ion-input type="number" formControlName="dni" placeholder="DNI"></ion-input>
     </ion-item>
     <div
       class="error-tooltip"
       *ngIf="formCliente.get('dni')?.touched && formCliente.get('dni')?.invalid"
     >
       <span *ngIf="formCliente.get('dni')?.hasError('required')">El DNI es obligatorio</span>
       <span *ngIf="formCliente.get('dni')?.hasError('minlength')">Debe tener al menos 7 dígitos</span>
     </div>
   </div>
 
   <div class="input-group">
     <ion-item>
       <ion-input formControlName="cuil" placeholder="CUIL"></ion-input>
     </ion-item>
     <div
       class="error-tooltip"
       *ngIf="formCliente.get('cuil')?.touched && formCliente.get('cuil')?.invalid"
     >
       <span *ngIf="formCliente.get('cuil')?.hasError('required')">El CUIL es obligatorio</span>
       <span *ngIf="formCliente.get('cuil')?.hasError('minlength')">Debe tener al menos 11 dígitos</span>
     </div>
   </div>
 
   <div class="input-group">
     <ion-item>
       <ion-input type="email" formControlName="email" placeholder="Correo electrónico"></ion-input>
     </ion-item>
     <div
       class="error-tooltip"
       *ngIf="formCliente.get('email')?.touched && formCliente.get('email')?.invalid"
     >
       <span *ngIf="formCliente.get('email')?.hasError('required')">El email es obligatorio</span>
       <span *ngIf="formCliente.get('email')?.hasError('email')">Formato de email inválido</span>
     </div>
   </div>
 
   <div class="input-group">
     <ion-item>
       <ion-input type="password" formControlName="password" placeholder="Contraseña"></ion-input>
     </ion-item>
     <div
       class="error-tooltip"
       *ngIf="formCliente.get('password')?.touched && formCliente.get('password')?.invalid"
     >
       <span *ngIf="formCliente.get('password')?.hasError('required')">La contraseña es obligatoria</span>
       <span *ngIf="formCliente.get('password')?.hasError('minlength')">Mínimo 6 caracteres</span>
     </div>
   </div>
 
   <div class="input-group">
     <ion-item>
       <ion-input type="password" formControlName="confirmar" placeholder="Confirmar contraseña"></ion-input>
     </ion-item>
     <div
       class="error-tooltip"
       *ngIf="formCliente.get('confirmar')?.touched && formCliente.get('confirmar')?.invalid"
     >
       <span *ngIf="formCliente.get('confirmar')?.hasError('required')">Debe confirmar la contraseña</span>
     </div>
   </div>
  </div>

    <!-- Previsualización de imagen -->
    <div *ngIf="imagenPreviewUrl" class="imagen-preview-container">
      <img
        [src]="imagenPreviewUrl"
        alt="Imagen seleccionada"
        class="imagen-preview"
      />
      <ion-button expand="block" color="danger" (click)="borrarImagen()">
        <ion-icon slot="start" name="trash-outline"></ion-icon>
        Eliminar imagen
      </ion-button>
    </div>

    <ion-button
      expand="block"
      color="medium"
      (click)="seleccionarFuenteImagen()"
    >
      <ion-icon slot="start" name="camera-outline"></ion-icon>
      Subir imagen
    </ion-button>

    <!-- SPINNER DE CARGA -->
    <ion-spinner
      *ngIf="subiendoImagen"
      name="crescent"
      color="medium"
      class="spinner-subida"
    ></ion-spinner>

    <ion-button
      expand="block"
      type="submit"
      color="success"
      [disabled]="formCliente.invalid"
    >
      REGISTRARSE
    </ion-button>

    <ion-button fill="clear" color="medium" (click)="volver()">
      VOLVER
    </ion-button>
  </form>
</ion-content>

<style>
  .imagen-preview-container {
    text-align: center;
    margin: 1rem 0;
  }
  .imagen-preview {
    max-width: 100%;
    border-radius: 8px;
    margin-bottom: 0.5rem;
  }
</style>
